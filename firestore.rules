rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    // Público: lectura de proyectos publicados
    match /projects/{projectId} {
      allow read: if resource.data.status == "published";
      allow write: if request.auth != null && request.auth.token.role == "admin";
    }

    // Artistas: lectura pública
    match /artists/{artistId} {
      allow read: if true;
      allow write: if request.auth != null && request.auth.token.role == "admin";
    }

    // Colecciones curatoriales
    match /collections/{collectionId} {
      allow read: if true;
      allow write: if request.auth != null && request.auth.token.role == "admin";
    }
    
    // Laboratorios y talleres
    match /labs/{labId} {
      allow read: if true;
      allow write: if request.auth != null && request.auth.token.role == "admin";
    }

    // Comunidad: acceso restringido
    match /community/{userId} {
      allow read, write: if request.auth != null && request.auth.uid == userId;
    }
  }
}
